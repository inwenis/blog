
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../post06/">
      
      
        <link rel="next" href="../post08/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.26">
    
    
      
        <title>post07 - programki.eu</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.6543a935.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-MZ0JN1EDPS"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-MZ0JN1EDPS",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-MZ0JN1EDPS",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#axios-cookies-more" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="programki.eu" class="md-header__button md-logo" aria-label="programki.eu" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            programki.eu
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              post07
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="programki.eu" class="md-nav__button md-logo" aria-label="programki.eu" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    programki.eu
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../post01/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    post01
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../post04/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    post04
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../post06/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    post06
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    post07
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    post07
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#axios" class="md-nav__link">
    <span class="md-ellipsis">
      axios
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#https-agents-handle-creatingclosing-sockets-tcp-etc-they-talk-to-the-os-manage-connection-to-hosts" class="md-nav__link">
    <span class="md-ellipsis">
      &gt; http/s agents handle creating/closing sockets, TCP, etc. They talk to the OS, manage connection to hosts.
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cookies" class="md-nav__link">
    <span class="md-ellipsis">
      cookies
    </span>
  </a>
  
    <nav class="md-nav" aria-label="cookies">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#http-cookie-agent" class="md-nav__link">
    <span class="md-ellipsis">
      http-cookie-agent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#axios-cookiejar-support" class="md-nav__link">
    <span class="md-ellipsis">
      axios-cookiejar-support
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tough-cookie" class="md-nav__link">
    <span class="md-ellipsis">
      tough-cookie
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a-bit-about-cookies" class="md-nav__link">
    <span class="md-ellipsis">
      A bit about cookies
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#random-stuff" class="md-nav__link">
    <span class="md-ellipsis">
      Random stuff
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#packages-we-dont-use" class="md-nav__link">
    <span class="md-ellipsis">
      Packages we don't use
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fetch-fetch-node-fetch" class="md-nav__link">
    <span class="md-ellipsis">
      fetch &amp; fetch &amp; node-fetch
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chat-gpt-crap" class="md-nav__link">
    <span class="md-ellipsis">
      chat-gpt crap
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#axios-and-fiddler" class="md-nav__link">
    <span class="md-ellipsis">
      axios and fiddler
    </span>
  </a>
  
    <nav class="md-nav" aria-label="axios and fiddler">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fiddler-and-client-certificates" class="md-nav__link">
    <span class="md-ellipsis">
      fiddler and client certificates
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#honorable-mentions" class="md-nav__link">
    <span class="md-ellipsis">
      honorable mentions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#axios-cookies-demo" class="md-nav__link">
    <span class="md-ellipsis">
      axios &amp; cookies demo
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#axios-certificates-etc" class="md-nav__link">
    <span class="md-ellipsis">
      axios, certificates, etc
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../post08/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    post08
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../post09/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    post09
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#axios" class="md-nav__link">
    <span class="md-ellipsis">
      axios
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#https-agents-handle-creatingclosing-sockets-tcp-etc-they-talk-to-the-os-manage-connection-to-hosts" class="md-nav__link">
    <span class="md-ellipsis">
      &gt; http/s agents handle creating/closing sockets, TCP, etc. They talk to the OS, manage connection to hosts.
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cookies" class="md-nav__link">
    <span class="md-ellipsis">
      cookies
    </span>
  </a>
  
    <nav class="md-nav" aria-label="cookies">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#http-cookie-agent" class="md-nav__link">
    <span class="md-ellipsis">
      http-cookie-agent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#axios-cookiejar-support" class="md-nav__link">
    <span class="md-ellipsis">
      axios-cookiejar-support
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tough-cookie" class="md-nav__link">
    <span class="md-ellipsis">
      tough-cookie
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a-bit-about-cookies" class="md-nav__link">
    <span class="md-ellipsis">
      A bit about cookies
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#random-stuff" class="md-nav__link">
    <span class="md-ellipsis">
      Random stuff
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#packages-we-dont-use" class="md-nav__link">
    <span class="md-ellipsis">
      Packages we don't use
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fetch-fetch-node-fetch" class="md-nav__link">
    <span class="md-ellipsis">
      fetch &amp; fetch &amp; node-fetch
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chat-gpt-crap" class="md-nav__link">
    <span class="md-ellipsis">
      chat-gpt crap
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#axios-and-fiddler" class="md-nav__link">
    <span class="md-ellipsis">
      axios and fiddler
    </span>
  </a>
  
    <nav class="md-nav" aria-label="axios and fiddler">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fiddler-and-client-certificates" class="md-nav__link">
    <span class="md-ellipsis">
      fiddler and client certificates
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#honorable-mentions" class="md-nav__link">
    <span class="md-ellipsis">
      honorable mentions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#axios-cookies-demo" class="md-nav__link">
    <span class="md-ellipsis">
      axios &amp; cookies demo
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#axios-certificates-etc" class="md-nav__link">
    <span class="md-ellipsis">
      axios, certificates, etc
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="axios-cookies-more">axios, cookies &amp; more</h1>
<h2 id="axios">axios</h2>
<p>axios - promise-based HTTP client for node.js</p>
<ul>
<li>when used in node.js axios uses http module (https://nodejs.org/api/http.html)</li>
<li>in node axios <strong>does not</strong> support cookies by itself (https://github.com/axios/axios/issues/5742)<ul>
<li>there are npm packages that add cookies support to axios</li>
</ul>
</li>
<li>when used in browsers it uses XMLHttpRequest</li>
<li>when used in browsers cookies work by default</li>
</ul>
<hr />
<p><em>Why would you use <code>axios</code> over plain <code>http</code> module from node?</em></p>
<blockquote>
<p>Axios makes http requests much easier. Try using plain <code>http</code> and you'll convince your self.</p>
</blockquote>
<hr />
<p><em>Are there other packages like <code>axios</code>?</em></p>
<blockquote>
<p>Yes - for example <code>node-fetch</code> https://github.com/node-fetch/node-fetch</p>
</blockquote>
<hr />
<p>When making a request axios creates a default <code>http</code> and <code>https</code> agent - https://axios-http.com/docs/req_config (axios probably uses <a href="https://nodejs.org/api/http.html#httpglobalagent">global agents</a>). You can specify custom agents for a specific request or set custom agents as default agents to use with an <code>axios</code> instance.</p>
<pre><code class="language-js">const a = require('axios');
const http = require('node:http');

(async () =&gt; {
    // configure your agent as needed
    const myCustomAgent = new http.Agent({ keepAlive: true });

    // use your custom agent for a specific request
    const x = await a.get('https://example.com/', { httpAgent: myCustomAgent });
    console.log(x);

    // set you agent as default for all requests
    a.default.httpAgent = myCustomAgent;
})();
</code></pre>
<hr />
<p><em>What are agents responsible for?</em></p>
<h2 id="https-agents-handle-creatingclosing-sockets-tcp-etc-they-talk-to-the-os-manage-connection-to-hosts">&gt; <code>http</code>/<code>s</code> agents handle creating/closing sockets, TCP, etc. They talk to the OS, manage connection to hosts.</h2>
<h2 id="cookies">cookies</h2>
<p>Without extra packages you need to code reading response headers, look for <code>Set-Cookie</code> headers. Store cookies somewhere. Code adding cookie headers to subsequent request.</p>
<h3 id="http-cookie-agent"><code>http-cookie-agent</code></h3>
<p>https://www.npmjs.com/package/http-cookie-agent</p>
<p>Manages cookies for node.js HTTP clients (e.g. Node.js global fetch, undici, axios, node-fetch).
<code>http-cookie-agent</code> implements a <code>http</code>/<code>s</code> agent that inspects request headers and does cookie related magic for you. It uses the class <code>CookieJar</code> from package <code>tough-cookie</code> to parse&amp;store cookies.</p>
<pre><code class="language-js">import axios from 'axios';
import { CookieJar } from 'tough-cookie';
import { HttpCookieAgent, HttpsCookieAgent } from 'http-cookie-agent/http';

const jar = new CookieJar();

const a = axios.create({
  httpAgent: new HttpCookieAgent({ cookies: { jar } }),
  httpsAgent: new HttpsCookieAgent({ cookies: { jar } }),
});
// now we have an axios instance supporting cookies
await a.get('https://example.com');
</code></pre>
<h3 id="axios-cookiejar-support"><code>axios-cookiejar-support</code></h3>
<p>https://www.npmjs.com/package/axios-cookiejar-support</p>
<p>Depends on <code>http-cookie-agent</code> and <code>tough-cookie</code>.
Does the same as <code>http-cookie-agent</code> but you don't have to create <code>http</code>/<code>s</code> agents yourself. This is a small package that just intercepts axios requests and makes sure custom <code>http</code>/<code>s</code> agents are used <a href="https://github.com/3846masa/axios-cookiejar-support/blob/main/src/index.ts">source</a>.</p>
<p>Saves you a bit of typing but you can't use your own custom agents. If you need to configure your <code>http</code>/<code>s</code> agents (ex. with a certificate) - use <code>http-cookie-agent</code> (see <a href="https://github.com/3846masa/axios-cookiejar-support/issues/431">github issue</a> and <a href="https://github.com/3846masa/axios-cookiejar-support/issues/426">github issue</a>)</p>
<pre><code class="language-js">import axios from 'axios';
import { wrapper } from 'axios-cookiejar-support';
import { CookieJar } from 'tough-cookie';

const jar = new CookieJar();
const client = wrapper(axios.create({ jar }));

await client.get('https://example.com');
</code></pre>
<h3 id="tough-cookie"><code>tough-cookie</code></h3>
<p>https://www.npmjs.com/package/tough-cookie</p>
<p>npm package - cookie parsing/storage/retrieval (<code>tough-cookie</code> itself does nothing with http request).</p>
<h3 id="a-bit-about-cookies">A bit about cookies</h3>
<p>https://datatracker.ietf.org/doc/html/rfc6265 - RFC describing cookies.</p>
<p>https://datatracker.ietf.org/doc/html/rfc6265#page-28 - concise paragraph on Third-party cookies.</p>
<p>Servers responds with a <code>Set-Cookie</code> header. Client can set the requested cookie. Cookies have a specific format described in this document.</p>
<h2 id="random-stuff">Random stuff</h2>
<p>https://npmtrends.com/cookie-vs-cookiejar-vs-cookies-vs-tough-cookie</p>
<p>interesting - <code>cookie</code> for servers are more popular than <code>tough-cookie</code> for clients since ~2023.</p>
<p>Is this due to more serve side apps being written in node?</p>
<h2 id="packages-we-dont-use">Packages we don't use</h2>
<ul>
<li><code>cookie</code> - npm package - cookies for servers</li>
<li><code>cookies</code> - npm package - cookies for servers (different then <code>cookie</code>)</li>
<li><code>cookiejar</code> - npm package - a different cookie jar for clients</li>
</ul>
<h2 id="fetch-fetch-node-fetch">fetch &amp; <code>fetch</code> &amp; <code>node-fetch</code></h2>
<p>fetch - standard created by WHATWG meant to replace <code>XMLHttpRequest</code> - https://fetch.spec.whatwg.org/</p>
<p><code>fetch</code> - an old npm package to fetch web content - don't use it</p>
<p><code>node-fetch</code> - community implemented <code>fetch</code> standard as a npm package - go ahead and use it</p>
<p><code>fetch</code> - node's native implementation of the <code>fetch</code> standard - https://nodejs.org/dist/latest-v21.x/docs/api/globals.html#fetch</p>
<p>Since <code>fetch</code> standard is the standard for both browsers and node chrome has a neat feature to export requests to <code>fetch</code></p>
<h2 id="chat-gpt-crap">chat-gpt crap</h2>
<p>When researching I came across some chat-gpt generated content.
You read it thinking it will be something but it's trash.</p>
<p>https://www.dhiwise.com/post/managing-secure-cookies-via-axios-interceptors
-&gt; this article from 2024 that tell you to implement cookies your self, doesn't even mention the word "package", "module"</p>
<p>https://medium.com/@stheodorejohn/managing-cookies-with-axios-simplifying-cookie-based-authentication-911e53c23c8a
-&gt; doesn't mention that cookies don't work in axios run in node without extra packages
    (at least this one mentions that chat-gpt helped, thought I bet it's fully written by chat-gpt)</p>
<hr />
<p>inco note - our http client is misleading, it uses same agent for http and https, it should maybe be called customAgent</p>
<h2 id="axios-and-fiddler">axios and fiddler</h2>
<p>Using a request interceptor (proxy) like fiddler helps during development and debugging.</p>
<p>To make fiddler intercept axios request we have to tell axios that there is a proxy where all requests from should go. The proxy forwards those requests to the actual destination.</p>
<pre><code>http_proxy=... // set proxy for http requests
https_proxy=... // set proxy for https requests
no_proxy=domain1.com,domain2.com // comma separated list of domains that should not be proxied
</code></pre>
<p>The proxy for both http and https can be the same url.</p>
<p>Read more - https://axios-http.com/docs/req_config</p>
<p>When using fiddler on windows I suggest going to <code>Network &amp; internet &gt; Proxy</code> and disableing proxies there (fiddler by default sets this). This way <code>fiddler</code> will only receive requests from the process where we set <code>http(s)_proxy</code> env vars.</p>
<h3 id="fiddler-and-client-certificates">fiddler and client certificates</h3>
<p>I was not able to make fiddler work with client certificates.
It should be done like this - https://docs.telerik.com/fiddler/configure-fiddler/tasks/respondwithclientcert but I couldn't get it to work</p>
<h2 id="honorable-mentions">honorable mentions</h2>
<p>I would like to try out - https://www.npmjs.com/package/proxy-agent at some point</p>
<p>I don't fully understand <code>withCredentials</code></p>
<h2 id="axios-cookies-demo">axios &amp; cookies demo</h2>
<pre><code>&gt; npm i
&gt; node server.mjs
open browser and go to http://127.0.0.1:3000
cookies are supported
&gt; node test.js (from another console)
cookies are not supported
</code></pre>
<h2 id="axios-certificates-etc">axios, certificates, etc</h2>
<p>To use axios with a client certificate you need to configure the https agent with the key and cert.
the key and cert need to be in pem format. They both can be in the same pem file, or in separate pem files.
(did not try it) but you should be able to merge and split your pem.</p>
<p>https://nodejs.org/api/tls.html#tlscreatesecurecontextoptions</p>
<p>to try out - https://www.npmjs.com/package/proxy-agent</p>









  




                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.ad660dcc.min.js"></script>
      
    
  </body>
</html>